{% extends 'base.html' %}
{% block content %}
<h2>{% if bill %}Uredi račun{% else %}Novi račun{% endif %}</h2>
{% if error %}<p class="error">{{ error }}</p>{% endif %}
<form method="post" action="/bills/save">
    {% if bill %}<input type="hidden" name="bill_id" value="{{ bill.id }}">{% endif %}
    <label>Tip režije
        <select name="utility_type" required>
            {% for t in utility_types %}
            <option value="{{ t.code }}" {% if bill and bill.utility_type == t.code %}selected{% endif %}>{{ t.name_hr }}</option>
            {% endfor %}
        </select>
    </label>
    <label>Mjesec potrošnje
        <input type="month" name="consumption_month" value="{% if bill %}{{ bill.consumption_month.strftime('%Y-%m') }}{% endif %}" required>
    </label>
    <label>Datum primitka
        <input type="date" name="received_date" value="{% if bill %}{{ bill.received_date.isoformat() }}{% endif %}" max="{{ request.state.today if request.state.today else '' }}" required>
    </label>
    <label>Iznos
        <input type="number" name="amount" step="0.01" min="0.01" value="{% if bill %}{{ bill.amount }}{% endif %}" required>
    </label>
    <label>Napomena
        <textarea name="note">{% if bill and bill.note %}{{ bill.note }}{% endif %}</textarea>
    </label>
    <button type="submit">Spremi</button>
</form>
<script>
const monthInput = document.querySelector('input[name="consumption_month"]');
monthInput.addEventListener('change', () => {
    if (monthInput.value) {
        monthInput.value = monthInput.value;
    }
});
</script>
{% endblock %}
